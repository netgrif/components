<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Netgrif Components Core library Documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css" media="(prefers-color-scheme: dark)">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">Netgrif Components Core library Documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">












<ol class="breadcrumb">
  <li>Interfaces</li>
  <li
  >
  Datafield</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>projects/netgrif-components-core/src/lib/search/models/category/case/case-dataset.ts</code>
        </p>




        <section>
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                        <a href="#fieldId" 
>
                                            fieldId
                                        </a>
                                </li>
                                <li>
                                        <a href="#fieldType" 
>
                                            fieldType
                                        </a>
                                </li>
                                <li>
                                        <a href="#netIdentifier" 
>
                                            netIdentifier
                                        </a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section>
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="fieldId"></a>
                                        <span class="name "><b>fieldId</b>
                                            <a href="#fieldId">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>fieldId:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="fieldType"></a>
                                        <span class="name "><b>fieldType</b>
                                            <a href="#fieldType">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>fieldType:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="netIdentifier"></a>
                                        <span class="name "><b>netIdentifier</b>
                                            <a href="#netIdentifier">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>netIdentifier:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { OperatorService } from &#x27;../../../operator-service/operator.service&#x27;;
import { LoggerService } from &#x27;../../../../logger/services/logger.service&#x27;;
import { Operator } from &#x27;../../operator/operator&#x27;;
import { Query } from &#x27;../../query/query&#x27;;
import { OptionalDependencies } from &#x27;../../../category-factory/optional-dependencies&#x27;;
import { SearchInputType } from &#x27;../search-input-type&#x27;;
import { DatafieldMapKey } from &#x27;../../datafield-map-key&#x27;;
import { SearchAutocompleteOption } from &#x27;../search-autocomplete-option&#x27;;
import { BooleanOperator } from &#x27;../../boolean-operator&#x27;;
import { CaseProcess } from &#x27;./case-process&#x27;;
import { EqualsDate } from &#x27;../../operator/equals-date&#x27;;
import { Substring } from &#x27;../../operator/substring&#x27;;
import { EqualsDateTime } from &#x27;../../operator/equals-date-time&#x27;;
import { Equals } from &#x27;../../operator/equals&#x27;;
import { BehaviorSubject, Observable, of, ReplaySubject, Subscription } from &#x27;rxjs&#x27;;
import { Category } from &#x27;../category&#x27;;
import { NotEquals } from &#x27;../../operator/not-equals&#x27;;
import { MoreThan } from &#x27;../../operator/more-than&#x27;;
import { LessThan } from &#x27;../../operator/less-than&#x27;;
import { InRange } from &#x27;../../operator/in-range&#x27;;
import { IsNull } from &#x27;../../operator/is-null&#x27;;
import { Like } from &#x27;../../operator/like&#x27;;
import { NotEqualsDate } from &#x27;../../operator/not-equals-date&#x27;;
import { MoreThanDate } from &#x27;../../operator/more-than-date&#x27;;
import { LessThanDate } from &#x27;../../operator/less-than-date&#x27;;
import { InRangeDate } from &#x27;../../operator/in-range-date&#x27;;
import { MoreThanDateTime } from &#x27;../../operator/more-than-date-time&#x27;;
import { LessThanDateTime } from &#x27;../../operator/less-than-date-time&#x27;;
import { InRangeDateTime } from &#x27;../../operator/in-range-date-time&#x27;;
import { AutocompleteOptions } from &#x27;../autocomplete-options&#x27;;
import { ConfigurationInput } from &#x27;../../configuration-input&#x27;;
import { SearchIndex } from &#x27;../../search-index&#x27;;
import { Categories } from &#x27;../categories&#x27;;
import { FormControl } from &#x27;@angular/forms&#x27;;
import moment, { Moment } from &#x27;moment&#x27;;
import { CategoryMetadataConfiguration } from &#x27;../../persistance/generator-metadata&#x27;;
import { MoreThanEqual } from &#x27;../../operator/more-than-equal&#x27;;
import { LessThanEqual } from &#x27;../../operator/less-than-equal&#x27;;
import { MoreThanEqualDate } from &#x27;../../operator/more-than-equal-date&#x27;;
import { LessThanEqualDate } from &#x27;../../operator/less-than-equal-date&#x27;;
import { MoreThanEqualDateTime } from &#x27;../../operator/more-than-equal-date-time&#x27;;
import { LessThanEqualDateTime } from &#x27;../../operator/less-than-equal-date-time&#x27;;
import { FilterTextSegment } from &#x27;../../persistance/filter-text-segment&#x27;;
import { UserAutocomplete } from &#x27;../user-autocomplete&#x27;;

interface Datafield {
    netIdentifier: string;
    fieldId: string;
    fieldType: string;
}

export class CaseDataset extends Category&lt;Datafield&gt; implements AutocompleteOptions {

    private static readonly _i18n &#x3D; &#x27;search.category.case.dataset&#x27;;
    protected static DISABLED_TYPES &#x3D; [&#x27;button&#x27;, &#x27;taskRef&#x27;, &#x27;caseRef&#x27;, &#x27;filter&#x27;];
    protected static readonly DATAFIELD_METADATA &#x3D; &#x27;datafield&#x27;;
    private static readonly AUTOCOMPLETE_ICON &#x3D; &#x27;account_circle&#x27;;

    protected readonly _DATAFIELD_INPUT: ConfigurationInput;

    protected _processCategory: CaseProcess;

    protected _configurationInputs$: BehaviorSubject&lt;Array&lt;ConfigurationInput&gt;&gt;;

    protected _datafieldOptions: Map&lt;string, Array&lt;Datafield&gt;&gt;;

    private _datafieldOptionsInitialized$: ReplaySubject&lt;void&gt;;
    private _allowedNetsSub: Subscription;
    private _userAutocomplete: UserAutocomplete;

    public static FieldTypeToInputType(fieldType: string): SearchInputType {
        switch (fieldType) {
            case &#x27;date&#x27;:
                return SearchInputType.DATE;
            case &#x27;dateTime&#x27;:
                return SearchInputType.DATE_TIME;
            case &#x27;number&#x27;:
                return SearchInputType.NUMBER;
            case &#x27;boolean&#x27;:
                return SearchInputType.BOOLEAN;
            case &#x27;user&#x27;:
                return SearchInputType.AUTOCOMPLETE;
            default:
                return SearchInputType.TEXT;
        }
    }

    constructor(operators: OperatorService, logger: LoggerService, protected _optionalDependencies: OptionalDependencies) {
        super(undefined,
            undefined,
            &#x60;${CaseDataset._i18n}.name&#x60;,
            undefined,
            logger,
            operators);

        this._processCategory &#x3D; this._optionalDependencies.categoryFactory.get(CaseProcess) as CaseProcess;
        this._processCategory.selectDefaultOperator();

        this._datafieldOptions &#x3D; new Map&lt;string, Array&lt;Datafield&gt;&gt;();
        this._userAutocomplete &#x3D; new UserAutocomplete(this._optionalDependencies);
        this.createDatafieldOptions();

        this._DATAFIELD_INPUT &#x3D; new ConfigurationInput(
            SearchInputType.AUTOCOMPLETE,
            &#x27;search.category.case.dataset.placeholder.field&#x27;,
            true,
            this._datafieldOptions,
            (mapKeys, newValue) &#x3D;&gt; {
                return mapKeys.map(serializedMapKey &#x3D;&gt; DatafieldMapKey.parse(serializedMapKey))
                    .filter(mapKey &#x3D;&gt; mapKey.title.toLocaleLowerCase().startsWith(newValue));
            }
        );

        this._configurationInputs$ &#x3D; new BehaviorSubject&lt;Array&lt;ConfigurationInput&gt;&gt;([this._DATAFIELD_INPUT]);

        this._DATAFIELD_INPUT.valueChanges$().subscribe(newValue &#x3D;&gt; {
            if (newValue &#x3D;&#x3D;&#x3D; undefined || typeof newValue &#x3D;&#x3D;&#x3D; &#x27;string&#x27;) {
                this._configurationInputs$.next([this._DATAFIELD_INPUT]);
            } else if (this._configurationInputs$.getValue().length &#x3D;&#x3D;&#x3D; 1) {
                this._configurationInputs$.next([this._DATAFIELD_INPUT, this._OPERATOR_INPUT]);
            }
            this._operatorFormControl.setValue(undefined);
        });
    }

    destroy() {
        super.destroy();
        this._configurationInputs$.complete();
        this._datafieldOptionsInitialized$.complete();
        if (this._allowedNetsSub &amp;&amp; !this._allowedNetsSub.closed) {
            this._allowedNetsSub.unsubscribe();
        }
        this._processCategory.destroy();
    }

    get configurationInputs$(): Observable&lt;Array&lt;ConfigurationInput&gt;&gt; {
        return this._configurationInputs$.asObservable();
    }

    public get inputType(): SearchInputType {
        if (!this.hasSelectedDatafields) {
            throw new Error(&#x27;Input type of arguments cannot be determined before selecting a data field during the configuration.&#x27;);
        }
        return CaseDataset.FieldTypeToInputType(this._selectedDatafields[0].fieldType);
    }

    /**
     * The allowed operators are dependant on the selected data field.
     *
     * Beware that if you want to change the order of the allowed operators, then you must also update the
     * [selectDefaultOperator()]{@link Category#selectDefaultOperator} method, so that default operator for each data field type matches
     * the default operator of the {@link CaseSimpleDataset} search category. Otherwise the transition of header search into the search GUI
     * won&#x27;t work properly.
     */
    public get allowedOperators(): Array&lt;Operator&lt;any&gt;&gt; {
        if (!this.hasSelectedDatafields) {
            return [];
        }
        switch (this._selectedDatafields[0].fieldType) {
            case &#x27;number&#x27;:
                return [
                    this._operatorService.getOperator(Equals),
                    this._operatorService.getOperator(NotEquals),
                    this._operatorService.getOperator(MoreThan),
                    this._operatorService.getOperator(MoreThanEqual),
                    this._operatorService.getOperator(LessThan),
                    this._operatorService.getOperator(LessThanEqual),
                    this._operatorService.getOperator(InRange),
                    this._operatorService.getOperator(IsNull)
                ];
            case &#x27;boolean&#x27;:
                return [
                    this._operatorService.getOperator(Equals),
                    this._operatorService.getOperator(NotEquals)
                ];
            case &#x27;user&#x27;:
            case &#x27;userList&#x27;:
                return [
                    this._operatorService.getOperator(Equals),
                    this._operatorService.getOperator(NotEquals),
                    this._operatorService.getOperator(IsNull)
                ];
            case &#x27;date&#x27;:
                return [
                    this._operatorService.getOperator(EqualsDate),
                    this._operatorService.getOperator(NotEqualsDate),
                    this._operatorService.getOperator(MoreThanDate),
                    this._operatorService.getOperator(MoreThanEqualDate),
                    this._operatorService.getOperator(LessThanDate),
                    this._operatorService.getOperator(LessThanEqualDate),
                    this._operatorService.getOperator(InRangeDate),
                    this._operatorService.getOperator(IsNull)
                ];
            case &#x27;dateTime&#x27;:
                return [
                    this._operatorService.getOperator(EqualsDateTime),
                    this._operatorService.getOperator(MoreThanDateTime),
                    this._operatorService.getOperator(MoreThanEqualDateTime),
                    this._operatorService.getOperator(LessThanDateTime),
                    this._operatorService.getOperator(LessThanEqualDateTime),
                    this._operatorService.getOperator(InRangeDateTime),
                    this._operatorService.getOperator(IsNull)
                ];
            default:
                return [
                    this._operatorService.getOperator(Substring),
                    this._operatorService.getOperator(Equals),
                    this._operatorService.getOperator(NotEquals),
                    this._operatorService.getOperator(IsNull),
                    this._operatorService.getOperator(Like)
                ];
        }
    }

    /**
     * @returns &#x60;CaseDataset&#x60; category is not displayed in bold for better readability
     */
    get displayBold(): boolean {
        return false;
    }

    public get hasSelectedDatafields(): boolean {
        return this._DATAFIELD_INPUT.isOptionSelected;
    }

    protected get _selectedDatafields(): Array&lt;Datafield&gt; {
        return this._datafieldOptions.get(this._DATAFIELD_INPUT.formControl.value.value);
    }

    public reset() {
        super.reset();
        this._DATAFIELD_INPUT.clear();
    }

    duplicate(): CaseDataset {
        return new CaseDataset(this._operatorService, this._log, this._optionalDependencies);
    }

    protected get elasticKeywords(): Array&lt;string&gt; {
        if (!this.hasSelectedDatafields) {
            return [];
        } else {
            return this._selectedDatafields.map(datafield &#x3D;&gt; this.resolveElasticKeyword(datafield));
        }
    }

    protected resolveElasticKeyword(datafield: Datafield): string {
        const resolver &#x3D; this._optionalDependencies.searchIndexResolver;
        switch (datafield.fieldType) {
            case &#x27;number&#x27;:
                return resolver.getIndex(datafield.fieldId, SearchIndex.NUMBER);
            case &#x27;date&#x27;:
            case &#x27;dateTime&#x27;:
                return resolver.getIndex(datafield.fieldId, SearchIndex.TIMESTAMP);
            case &#x27;boolean&#x27;:
                return resolver.getIndex(datafield.fieldId, SearchIndex.BOOLEAN);
            case &#x27;file&#x27;:
            case &#x27;fileList&#x27;:
                return resolver.getIndex(datafield.fieldId, SearchIndex.FILE_NAME,
                    this.isSelectedOperator(Equals) || this.isSelectedOperator(NotEquals) || this.isSelectedOperator(Substring)
                    || this.isSelectedOperator(IsNull));
            case &#x27;user&#x27;:
            case &#x27;userList&#x27;:
                return resolver.getIndex(datafield.fieldId, SearchIndex.USER_ID);
            case &#x27;i18n&#x27;:
                return resolver.getIndex(datafield.fieldId, SearchIndex.TEXT, this.isSelectedOperator(Equals) || this.isSelectedOperator(NotEquals) || this.isSelectedOperator(Substring)
                    || this.isSelectedOperator(IsNull));
            default:
                return resolver.getIndex(datafield.fieldId, SearchIndex.FULLTEXT,
                    this.isSelectedOperator(Equals) || this.isSelectedOperator(NotEquals) || this.isSelectedOperator(Substring)
                    || this.isSelectedOperator(IsNull));
        }
    }

    get inputPlaceholder(): string {
        if (!this.hasSelectedDatafields) {
            return &#x60;${CaseDataset._i18n}.placeholder.field&#x60;;
        }
        return &#x60;${CaseDataset._i18n}.placeholder.value&#x60;;
    }

    protected get datafieldOptionsInitialized$(): Observable&lt;void&gt; {
        return this._datafieldOptionsInitialized$.asObservable();
    }

    protected generateQuery(userInput: Array&lt;unknown&gt;): Query {
        let queryGenerationStrategy;
        if (this.isSelectedOperator(IsNull)) {
            queryGenerationStrategy &#x3D; (d, _) &#x3D;&gt; this.isNullOperatorQueryGenerationStrategy(d);
        } else if (this.inputType &#x3D;&#x3D;&#x3D; SearchInputType.AUTOCOMPLETE) {
            queryGenerationStrategy &#x3D; (d, ui) &#x3D;&gt; this.standardQueryGenerationStrategy(d, ui[0], false);
        } else {
            queryGenerationStrategy &#x3D; (d, ui) &#x3D;&gt; this.standardQueryGenerationStrategy(d, ui);
        }

        const queries &#x3D; this._selectedDatafields.map(datafield &#x3D;&gt; queryGenerationStrategy(datafield, userInput));
        return Query.combineQueries(queries, BooleanOperator.OR);
    }

    protected standardQueryGenerationStrategy(datafield: Datafield, userInput: Array&lt;unknown&gt;, escapeInput &#x3D; true): Query {
        const valueQuery &#x3D; this.selectedOperator.createQuery(this.elasticKeywords, userInput, escapeInput);
        const netQuery &#x3D; this.generateNetConstraint(datafield);
        return Query.combineQueries([valueQuery, netQuery], BooleanOperator.AND);
    }

    protected isNullOperatorQueryGenerationStrategy(datafield: Datafield): Query {
        const constraint &#x3D; this.generateNetConstraint(datafield);
        return (this._operatorService.getOperator(IsNull) as IsNull).createQueryWithConstraint(this.elasticKeywords, constraint);
    }

    protected generateNetConstraint(datafield: Datafield): Query {
        return this._processCategory.generatePredicate([[datafield.netIdentifier]]).query;
    }

    protected createDatafieldOptions(): void {
        this._datafieldOptionsInitialized$ &#x3D; new ReplaySubject&lt;void&gt;(1);
        this._allowedNetsSub &#x3D; this._optionalDependencies.allowedNetsService.allowedNets$.subscribe(allowedNets &#x3D;&gt; {
            allowedNets.forEach(petriNet &#x3D;&gt; {
                petriNet.immediateData
                    .filter(immediateData &#x3D;&gt; {
                        return immediateData.title !&#x3D;&#x3D; undefined
                            &amp;&amp; immediateData.title.trim().length &gt; 0
                            &amp;&amp; !CaseDataset.DISABLED_TYPES.includes(immediateData.type);
                    })
                    .forEach(immediateData &#x3D;&gt; {
                        let type &#x3D; immediateData.type;

                        // for search purposes, enumeration and multichoice maps are equivalent to their simpler counterparts
                        if (type &#x3D;&#x3D;&#x3D; &#x27;enumeration_map&#x27;) {
                            type &#x3D; &#x27;enumeration&#x27;;
                        } else if (type &#x3D;&#x3D;&#x3D; &#x27;multichoice_map&#x27;) {
                            type &#x3D; &#x27;multichoice&#x27;;
                        }

                        this.addToDatafieldOptionsMap(DatafieldMapKey.serializedForm(immediateData.type, immediateData.title), {
                            netIdentifier: petriNet.identifier,
                            fieldId: immediateData.stringId,
                            fieldType: immediateData.type,
                        });
                    });
            });
            this._datafieldOptionsInitialized$.next();
        });
    }

    filterOptions(userInput: Observable&lt;string | SearchAutocompleteOption&lt;Array&lt;string&gt;&gt;&gt;):
        Observable&lt;Array&lt;SearchAutocompleteOption&lt;Array&lt;string&gt;&gt;&gt;&gt; {

        if (!this.hasSelectedDatafields) {
            throw new Error(&#x27;The category must be fully configured before attempting to get autocomplete options!&#x27;);
        }
        if (this.inputType !&#x3D;&#x3D; SearchInputType.AUTOCOMPLETE) {
            throw new Error(&#x27;Cannot filter options of non-autocomplete operands&#x27;);
        }

        return this._userAutocomplete.filterOptions(userInput);
    }

    public selectDatafields(datafieldMapKey: string, selectDefaultOperator &#x3D; true): void {
        if (!this._datafieldOptions.has(datafieldMapKey)) {
            this._log.warn(&#x60;The provided &#x27;datafieldMapKey&#x27; (${datafieldMapKey}) does not exist.&#x60;);
            return;
        }
        this._DATAFIELD_INPUT.formControl.setValue(DatafieldMapKey.parse(datafieldMapKey));
        if (selectDefaultOperator) {
            this.selectDefaultOperator();
        }
    }

    /**
     * Adds a new entry or pushes value into an existing entry.
     * When a new entry is created, it is created as an Array of one element.
     * @param key where in the map should the value be added
     * @param value the value that should be added to the map
     */
    protected addToDatafieldOptionsMap(key: string, value: Datafield): void {
        if (this._datafieldOptions.has(key)) {
            this._datafieldOptions.get(key).push(value);
        } else {
            this._datafieldOptions.set(key, [value]);
        }
    }

    protected isOperandValueSelected(newValue: any): boolean {
        if (!this.isOperatorSelected()) {
            return false;
        }
        let inputType: SearchInputType;
        try {
            inputType &#x3D; this.inputType;
        } catch (e) {
            return false;
        }

        switch (inputType) {
            case SearchInputType.NUMBER:
                return typeof newValue &#x3D;&#x3D;&#x3D; &#x27;number&#x27;;
            case SearchInputType.BOOLEAN:
                return typeof newValue &#x3D;&#x3D;&#x3D; &#x27;boolean&#x27;;
            case SearchInputType.AUTOCOMPLETE:
                return !(!newValue || typeof newValue &#x3D;&#x3D;&#x3D; &#x27;string&#x27;);
            default:
                return !!newValue;
        }
    }

    /**
     * Performs a transformation of the &#x60;FormControl&#x60; value before passing it into the selected &#x60;Operator&#x60; for query generation.
     * It is mostly useful only for AutocompleteCategories, where the selected value of the FormControl is an object.
     *
     * @param value the FormControlValue
     * @returns If the selected data field has input type &#x60;AUTOCOMPLETE&#x60; then returns the {@link SearchAutocompleteOption} &#x60;value&#x60;
     * attribute. Otherwise performs an identity operation.
     */
    protected transformCategoryValue(value: any): any {
        if (this.inputType &#x3D;&#x3D;&#x3D; SearchInputType.AUTOCOMPLETE) {
            return (value as SearchAutocompleteOption&lt;Array&lt;number&gt;&gt;).value;
        }
        return value;
    }

    serializeClass(): Categories | string {
        return Categories.CASE_DATASET;
    }

    protected serializeOperandValue(valueFormControl: FormControl): unknown {
        switch (this.inputType) {
            case SearchInputType.AUTOCOMPLETE:
                return this._userAutocomplete.serializeOperandValue(valueFormControl);
            case SearchInputType.DATE:
            case SearchInputType.DATE_TIME:
                return (valueFormControl.value as Moment).valueOf();
            default:
                return super.serializeOperandValue(valueFormControl);
        }
    }

    protected createMetadataConfiguration(): CategoryMetadataConfiguration {
        const config &#x3D; super.createMetadataConfiguration();
        config[CaseDataset.DATAFIELD_METADATA] &#x3D; (this._DATAFIELD_INPUT.formControl.value as DatafieldMapKey).toSerializedForm();
        return config;
    }

    protected loadConfigurationFromMetadata(configuration: CategoryMetadataConfiguration): Observable&lt;void&gt; {
        const result$ &#x3D; new ReplaySubject&lt;void&gt;(1);
        this.datafieldOptionsInitialized$.subscribe(() &#x3D;&gt; {
            const serializedMapKey &#x3D; configuration[CaseDataset.DATAFIELD_METADATA] as string;
            this.selectDatafields(serializedMapKey, false);
            if (!this.hasSelectedDatafields) {
                throw new Error(&#x60;Searched data fields cannot be restored from the provided configuration (${serializedMapKey
                }). Make sure, that the correct allowed nets are provided in this view.&#x60;);
            }
            super.loadConfigurationFromMetadata(configuration).subscribe(() &#x3D;&gt; {
                result$.next();
                result$.complete();
            });
        });
        return result$.asObservable();
    }

    protected deserializeOperandValue(value: unknown): Observable&lt;any&gt; {
        switch (this.inputType) {
            case SearchInputType.AUTOCOMPLETE:
                return this._userAutocomplete.deserializeOperandValue(value as SearchAutocompleteOption&lt;Array&lt;string&gt;&gt;);
            case SearchInputType.DATE:
            case SearchInputType.DATE_TIME:
                return of(moment(value as string));
            default:
                return super.deserializeOperandValue(value);
        }
    }

    protected createConfigurationFilterTextSegments(): Array&lt;FilterTextSegment&gt; {
        return [{segment: this._configurationInputs$.value[0].formControl.value.text, bold: true}];
    }
}
</code></pre>
    </div>
</div>


                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'Datafield.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       
       <script type="module" src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
